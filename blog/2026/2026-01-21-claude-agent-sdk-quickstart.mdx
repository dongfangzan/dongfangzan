---
title: Claude Agent SDK å¼€å‘æŒ‡å—1 - QuickStart
sticky: true
authors:
  - name: ä¸œæ–¹èµ
    title: ç¨‹åºå‘˜/æ³¨å†Œä¼šè®¡å¸ˆ
    url: https://github.com/dongfangzan
    image_url: https://hx-zsy.oss-cn-chengdu.aliyuncs.com/img/202412021355421.png
tags: [Claude Code]
---

AIå‘å±•åˆ°äº†2026å¹´ï¼Œè¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å·²ç»å¼€å§‹æ³¨æ„åˆ°ï¼Œéœ€è¦è½åœ°AIåº”ç”¨ï¼Œå•çº¯ä¾èµ–å¤§æ¨¡å‹èƒ½åŠ›å·²ç»è¿œè¿œä¸å¤Ÿäº†

å¤§å®¶å¼€å§‹é€æ­¥å¼€å‘è½åœ°AIåº”ç”¨ï¼Œè€ŒClaude Agent SDKçš„å‡ºç°ï¼Œæ— ç–‘ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªæå…¶ä¾¿åˆ©çš„å·¥å…·

æœ¬ç³»åˆ—æ–‡ç« ï¼Œæˆ‘ä»¬å°±æ¥ä»‹ç»Claude Agent SDKçš„ä½¿ç”¨æ–¹æ³•å’Œä¸€äº›å®æˆ˜ç»éªŒ

{/* truncate */}
# ä»€ä¹ˆæ˜¯Claude Agent SDK
ä½¿ç”¨ Claude Code ä½œä¸ºåº“æ„å»ºç”Ÿäº§çº§ AI ä»£ç†

æ„å»ºèƒ½å¤Ÿè‡ªä¸»è¯»å–æ–‡ä»¶ã€è¿è¡Œå‘½ä»¤ã€æœç´¢ç½‘ç»œã€ç¼–è¾‘ä»£ç ç­‰çš„ AI ä»£ç†ã€‚Agent SDK ä¸ºæ‚¨æä¾›äº†ä¸ Claude Code ç›¸åŒçš„å·¥å…·ã€ä»£ç†å¾ªç¯å’Œä¸Šä¸‹æ–‡ç®¡ç†ï¼Œå¯åœ¨ Python å’Œ TypeScript ä¸­ç¼–ç¨‹ã€‚

Agent SDK åŒ…å«ç”¨äºè¯»å–æ–‡ä»¶ã€è¿è¡Œå‘½ä»¤å’Œç¼–è¾‘ä»£ç çš„å†…ç½®å·¥å…·ï¼Œå› æ­¤æ‚¨çš„ä»£ç†å¯ä»¥ç«‹å³å¼€å§‹å·¥ä½œï¼Œæ— éœ€æ‚¨å®ç°å·¥å…·æ‰§è¡Œã€‚æ·±å…¥äº†è§£å¿«é€Ÿå…¥é—¨æˆ–æ¢ç´¢ä½¿ç”¨ SDK æ„å»ºçš„çœŸå®ä»£ç†

[å®˜æ–¹æ–‡æ¡£åœ°å€](https://platform.claude.com/docs/zh-CN/agent-sdk/overview)

> ä»¥ä¸Šæ˜¯å®˜æ–¹å¯¹Claude Agent SDKçš„ä»‹ç»

# å¿«é€Ÿå¼€å§‹
ä¸‹é¢æˆ‘ä»¬å°±æ¥å¿«é€Ÿä½“éªŒä¸€ä¸‹Claude Agent SDKçš„ä½¿ç”¨æ–¹æ³•

## ç¯å¢ƒå‡†å¤‡
- Node.js 18+ æˆ– Python 3.10+
- ä¸€ä¸ªAnthropicè´¦æˆ·
- æˆ–æ”¯æŒå…¼å®¹Anthropic APIçš„æ¨¡å‹ï¼ˆä½ å¯ä»¥ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„Ollamaè¿›è¡Œæœ¬åœ°æµ‹è¯•ï¼‰

> ä»¥ä¸‹éƒ½æ˜¯ç”¨Pythonç‰ˆæœ¬è¿›è¡Œæ¼”ç¤º

## å®‰è£…
### Claude Code å®‰è£…
Agent SDKæ˜¯ä½¿ç”¨Claude Codeä½œä¸ºå…¶è¿è¡Œæ—¶çš„ï¼Œæ‰€ä»¥ä½ éœ€è¦å…ˆå®‰è£…Claude Code

```bash
# macOS/Linux/WSL
curl -fsSL https://claude.ai/install.sh | bash
```
æˆ–è€…ä½¿ç”¨npmè¿›è¡Œå®‰è£…
```bash
npm install -g @anthropic-ai/claude-code
```
### å®‰è£…Agent SDKåŒ…
```bash
# TypeScript
npm install @anthropic-ai/claude-agent-sdk
```
```bash
# Python
pip install claude-agent-sdk
```
### é…ç½®æœ¬åœ°ç¯å¢ƒå˜é‡
```
ANTHROPIC_API_KEY=sk-ant-your-key-here
å…¼å®¹Anthropic APIçš„åœ°å€
# ANTHROPIC_BASE_URL=http://localhost:3456
```


## Hello World ç¤ºä¾‹

ç¼–å†™ä»£ç å¦‚ä¸‹
```Python
import asyncio
from claude_agent_sdk import query, ClaudeAgentOptions, AssistantMessage, ResultMessage

async def main():
    # Agentic loop: streams messages as Claude works
    async for message in query(
        prompt="ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±",
        options=ClaudeAgentOptions(
            allowed_tools=["Read"],  # Tools Claude can use
        )
    ):
        # Print human-readable output
        if isinstance(message, AssistantMessage):
            for block in message.content:
                if hasattr(block, "text"):
                    print(block.text)              # Claude's reasoning
                elif hasattr(block, "name"):
                    print(f"Tool: {block.name}")   # Tool being called
        elif isinstance(message, ResultMessage):
            print(f"Done: {message.subtype}")      # Final result

asyncio.run(main())

# Output:
# æˆ‘æ˜¯ Claudeï¼Œç”± Anthropic å¼€å‘çš„ AI åŠ©æ‰‹ã€‚æˆ‘å¯ä»¥åœ¨å¯¹è¯ä¸­å¸®åŠ©ä½ å®Œæˆå„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ï¼š

# **ğŸ’» ç¼–ç¨‹ä¸å¼€å‘**
# - ç¼–å†™ã€å®¡æŸ¥å’Œè°ƒè¯•ä»£ç 
# - å¸®åŠ©è®¾è®¡è½¯ä»¶æ¶æ„
# - ä¿®å¤ bug å’Œä¼˜åŒ–æ€§èƒ½
# - è¿è¡Œå‘½ä»¤å’Œæµ‹è¯•
```


# Agentèƒ½åŠ›ç¤ºä¾‹

ä¸ºäº†å±•ç¤ºAgentçš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒè¯»å–ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œä»¥å®˜æ–¹æ–‡æ¡£ä¸­çš„ä¾‹å­ä¸ºä¾‹

é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å‡†å¤‡ä¸€ä¸ªæœ‰ç¼ºé™·çš„ä»£ç å¦‚ä¸‹ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°å«åš`utils.py`ï¼š
```Python
def calculate_average(numbers):
    total = 0
    for num in numbers:
        total += num
    return total / len(numbers)

def get_user_name(user):
    return user["name"].upper()
```
åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦é”™è¯¯
1. `calculate_average` å‡½æ•°åœ¨è®¡ç®—å¹³å‡å€¼æ—¶æ²¡æœ‰å¤„ç†ç©ºåˆ—è¡¨çš„æƒ…å†µï¼Œè¿™ä¼šå¯¼è‡´é™¤ä»¥é›¶çš„é”™è¯¯ã€‚
2. `get_user_name` å‡½æ•°å‡è®¾ä¼ å…¥çš„ `user` å­—å…¸ä¸­æ€»æ˜¯åŒ…å« `name` é”®ï¼Œå¦‚æœç¼ºå°‘è¯¥é”®ä¼šå¼•å‘ `KeyError`ã€‚

æˆ‘ä»¬ä½¿ç”¨Agent SDKæ¥è®©Claudeè‡ªåŠ¨ä¿®å¤è¿™äº›é”™è¯¯
```Python
import asyncio
from claude_agent_sdk import query, ClaudeAgentOptions, AssistantMessage, ResultMessage

async def main():
    # Agentæ‰§è¡Œå¾ªç¯
    async for message in query(
        prompt="è¯·å®¡æŸ¥ä»£ç utils.pyï¼ŒæŸ¥æ‰¾å¯èƒ½å¯¼è‡´å´©æºƒçš„é”™è¯¯ã€‚ä¿®å¤ä½ å‘ç°çš„ä»»ä½•é—®é¢˜ã€‚",
        options=ClaudeAgentOptions(
            allowed_tools=["Read", "Edit", "Glob"],  # å¯ä»¥ä½¿ç”¨çš„å·¥å…·
            permission_mode="acceptEdits"            # è‡ªåŠ¨æ‰¹å‡†æ–‡ä»¶ç¼–è¾‘
        )
    ):
        # æ‰“å°äººç±»å¯è¯»çš„è¾“å‡º
        if isinstance(message, AssistantMessage):
            for block in message.content:
                if hasattr(block, "text"):
                    print(block.text)              # Claudeçš„æ¨ç†è¿‡ç¨‹
                elif hasattr(block, "name"):
                    print(f"Tool: {block.name}")   # è°ƒç”¨çš„å·¥å…·
        elif isinstance(message, ResultMessage):
            print(f"Done: {message.subtype}")      # æœ€ç»ˆç»“æœ
asyncio.run(main())
```

å¯ä»¥çœ‹åˆ°è¾“å‡ºå†…å®¹å¦‚ä¸‹
```
æˆ‘ä¼šå¸®æ‚¨å®¡æŸ¥å¹¶ä¿®å¤ utils.py æ–‡ä»¶ä¸­çš„æ½œåœ¨é”™è¯¯ã€‚è®©æˆ‘å…ˆè¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚
Tool: Glob
Tool: Read
æˆ‘å‘ç°äº†è¿™ä¸ªæ–‡ä»¶ä¸­å­˜åœ¨å‡ ä¸ªå¯èƒ½å¯¼è‡´å´©æºƒçš„é”™è¯¯ï¼š

## å‘ç°çš„é—®é¢˜ï¼š

1. **`calculate_average` å‡½æ•° - é›¶é™¤é”™è¯¯**ï¼šå½“ `numbers` ä¸ºç©ºåˆ—è¡¨æ—¶ï¼Œ`len(numbers)` è¿”å› 0ï¼Œå¯¼è‡´é™¤é›¶é”™è¯¯ã€‚

2. **`get_user_name` å‡½æ•° - KeyError**ï¼šå½“ä¼ å…¥çš„å­—å…¸ä¸­æ²¡æœ‰ "name" é”®æ—¶ï¼Œä¼šæŠ›å‡º KeyErrorã€‚

3. **`get_user_name` å‡½æ•° - AttributeError**ï¼šå¦‚æœ `user` ä¸æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œæˆ–è€… `user["name"]` ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè°ƒç”¨ `.upper()` ä¼šå¤±è´¥ã€‚

4. **`get_user_name` å‡½æ•° - TypeError**ï¼šå¦‚æœä¼ å…¥çš„ä¸æ˜¯å­—å…¸ç±»å‹ï¼Œç´¢å¼•æ“ä½œ `user["name"]` ä¼šå¤±è´¥ã€‚

ç°åœ¨è®©æˆ‘ä¿®å¤è¿™äº›é—®é¢˜ï¼š
Tool: Edit
Tool: Edit
å®Œæˆï¼æˆ‘å·²ç»ä¿®å¤äº†æ‰€æœ‰å¯èƒ½å¯¼è‡´å´©æºƒçš„é”™è¯¯ã€‚ä»¥ä¸‹æ˜¯ä¿®å¤çš„è¯¦ç»†è¯´æ˜ï¼š

## ä¿®å¤å†…å®¹ï¼š

### 1. `calculate_average` å‡½æ•°
**é—®é¢˜**ï¼šç©ºåˆ—è¡¨ä¼šå¯¼è‡´ `ZeroDivisionError`
**ä¿®å¤**ï¼šæ·»åŠ äº†ç©ºåˆ—è¡¨æ£€æŸ¥ï¼Œå½“åˆ—è¡¨ä¸ºç©ºæ—¶è¿”å› 0

### 2. `get_user_name` å‡½æ•°
**é—®é¢˜**ï¼šå¤šä¸ªæ½œåœ¨é”™è¯¯
- `KeyError`ï¼šå­—å…¸ä¸­æ²¡æœ‰ "name" é”®
- `AttributeError`ï¼šä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹æ— æ³•è°ƒç”¨ `.upper()`
- `TypeError`ï¼šä¼ å…¥çš„ä¸æ˜¯å­—å…¸ç±»å‹

**ä¿®å¤**ï¼š
- æ£€æŸ¥ `user` æ˜¯å¦ä¸ºç©ºæˆ–ä¸æ˜¯å­—å…¸ç±»å‹
- ä½¿ç”¨ `.get()` æ–¹æ³•å®‰å…¨åœ°è·å– "name" å€¼ï¼Œé¿å… `KeyError`
- ä½¿ç”¨ `str()` è½¬æ¢ç¡®ä¿ç±»å‹æ­£ç¡®
- æ·»åŠ ç©ºå­—ç¬¦ä¸²æ£€æŸ¥ï¼Œé¿å…å¯¹ç©ºå€¼è°ƒç”¨ `.upper()`

ç°åœ¨è¿™ä¸¤ä¸ªå‡½æ•°éƒ½å…·æœ‰æ›´å¼ºçš„å¥å£®æ€§ï¼Œèƒ½å¤Ÿå¤„ç†å„ç§è¾¹ç•Œæƒ…å†µè€Œä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚
```

éšåæ£€æŸ¥`utils.py`æ–‡ä»¶ï¼Œå‘ç°ä»£ç å·²ç»è¢«è‡ªåŠ¨ä¿®å¤ä¸ºå¦‚ä¸‹å†…å®¹
```Python
def calculate_average(numbers):
    if not numbers:
        return 0
    total = 0
    for num in numbers:
        total += num
    return total / len(numbers)

def get_user_name(user):
    if not user or not isinstance(user, dict):
        return ""
    name = user.get("name", "")
    return str(name).upper() if name else ""
```

å¯ä»¥çœ‹åˆ°ï¼Œ**åªéœ€è¦å‡ åˆ†é’Ÿæ—¶é—´**ï¼Œæˆ‘ä»¬å°±ç”¨agent sdkå®ç°äº†ä¸€ä¸ªè‡ªåŠ¨è¯»å–ï¼Œè‡ªåŠ¨ä¿®æ”¹ä»£ç çš„AI Agent

å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ›´æ”¹ä¸€äº›å‚æ•°ï¼Œæ¥ä¿®æ”¹Agentçš„èƒ½åŠ›ï¼Œæ¯”å¦‚å¢åŠ ç½‘ç»œæœç´¢
```Python
options=ClaudeAgentOptions(
    allowed_tools=["Read", "Edit", "Glob", "WebSearch"],
    permission_mode="acceptEdits"
)
```

æˆ–è€…ç»™Claudeä¸€ä¸ªè‡ªå®šä¹‰çš„ç³»ç»Ÿæç¤ºè¯
```Python
options=ClaudeAgentOptions(
    allowed_tools=["Read", "Edit", "Glob"],
    permission_mode="acceptEdits",
    system_prompt="ä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„Pythonå¼€å‘è€…ï¼Œè¯·å¸®æˆ‘å®¡æŸ¥å¹¶ä¿®å¤ä»£ç ä¸­çš„é”™è¯¯ã€‚"
)
```

äº¦æˆ–è€…ç›´æ¥æ‰§è¡Œbashå‘½ä»¤
```Python
options=ClaudeAgentOptions(
    # å…è®¸Bashå·¥å…·
    allowed_tools=["Read", "Edit", "Glob", "Bash"],
    permission_mode="acceptEdits"
)
```
## å·¥å…·
å·¥å…·æ˜¯Claude Agent SDKçš„æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€

å®ƒå¯ä»¥æ§åˆ¶ä½ çš„Agentèƒ½å¤Ÿæ‰§è¡Œå“ªäº›æ“ä½œ
å·¥å…·|Agentèƒ½å¤Ÿåšä»€ä¹ˆ
:-|:-
Readã€Globã€Grepã€WebSearch|åªè¯»ã€åˆ†æï¼ŒèŠå¤©åŠ©æ‰‹
Readã€Editã€Glob|ä¿®æ”¹ã€åˆ†æä»£ç ï¼Œå¯¹æƒé™è¦æ±‚é«˜
Readã€Editã€Globã€Bashã€Grep|å®Œå…¨è‡ªåŠ¨å·¥å…·

## æƒé™æ¨¡å¼
æƒé™æ¨¡å¼(permission_mode)ä¸»è¦ç”¨äºæ§åˆ¶ä½ éœ€è¦å¤šå°‘äººå·¥å¹²é¢„
æ¨¡å¼|è¡Œä¸º|è¯´æ˜
:-|:-|:-
acceptEdits|è‡ªåŠ¨æ‰¹å‡†æ–‡ä»¶ç¼–è¾‘ï¼Œè¯¢é—®å…¶ä»–æ“ä½œ|å—ä¿¡ä»»çš„å¼€å‘å·¥ä½œæµ
bypassPermissions|æ— æç¤ºè¿è¡Œ|é€‚åˆå®Œå…¨è‡ªåŠ¨åŒ–åœºæ™¯
default|éœ€è¦äººå·¥æ‰¹å‡†|è‡ªå®šä¹‰æ‰¹å‡†æµç¨‹

æ›´å¤šæƒé™æ¨¡å¼çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥æˆ‘ä»¬ä»¥åå†æ¥æ¢è®¨

# æ€»ç»“
æˆªæ­¢åˆ°è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†Claude Agent SDKçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•

ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„OpenAIçš„`/chat/completions`æ¥å£ç›¸æ¯”

Claude Agent SDKå®Œæ•´çš„å°è£…äº†Agentçš„èƒ½åŠ›ï¼Œè®©ä½ ä¸ç”¨å†å…³å¿ƒ
1. å¦‚ä½•ç®¡ç†ä¸Šä¸‹æ–‡
2. å¦‚ä½•è°ƒç”¨å·¥å…·
3. å¦‚ä½•å¤„ç†å¤šè½®å¯¹è¯
4. å¦‚ä½•å¤„ç†æ–‡ä»¶è¯»å†™
ç­‰ç­‰å¤æ‚çš„é€»è¾‘ï¼Œä¹Ÿè®©ä½ å¯ä»¥æ›´ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°

ç›¸è¾ƒäº`LangChain`ç­‰æ¡†æ¶ï¼ŒClaude Agent SDKå°†æ•´ä¸ªThink-Act-Observeæµç¨‹è¿›è¡Œäº†é«˜åº¦å°è£…ï¼Œä¸”æ€§èƒ½æ›´ä¼˜ï¼Œä½¿ç”¨ä½“éªŒæ›´å¥½
![](https://hx-zsy.oss-cn-chengdu.aliyuncs.com/img/202601211625185.png)

å¥½äº†ä»Šå¤©çš„å¿«é€Ÿå…¥é—¨å°±åˆ°è¿™é‡Œï¼Œæ„Ÿè°¢ä½ çœ‹åˆ°è¿™é‡Œï¼Œä¸‹æœŸè§